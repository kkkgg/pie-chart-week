<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ›œæ—¥ã‚ˆã†ã³</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
                Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue',
                sans-serif;
            display: grid;
            place-items: center;
            min-height: 95vh;
            background-color: #f0f2f5;
            color: #333;
        }

        h1 {
            font-weight: 300;
            color: #555;
        }

        .chart-container {
            width: 90vw;
            max-width: 400px;
            position: relative;
        }

        #pie-chart {
            width: 100%;
            height: 100%;
            /* ä»Šæ—¥ã®ãƒ”ãƒ¼ã‚¹ãŒæ‹¡å¤§ã—ãŸã¨ãã«è¦‹åˆ‡ã‚Œãªã„ã‚ˆã†ã« */
            overflow: visible; 
        }

        /* å„æ›œæ—¥ã®ã‚°ãƒ«ãƒ¼ãƒ— */
        .day-group {
            cursor: pointer;
            transition: transform 0.3s ease, filter 0.3s ease;
        }

        /* æ›œæ—¥ã®ãƒ”ãƒ¼ã‚¹ï¼ˆæ‰‡å½¢ï¼‰ */
        .day-slice {
            stroke: rgba(255, 255, 255, 0.5); /* ãƒ”ãƒ¼ã‚¹é–“ã®å¢ƒç•Œç·š */
            stroke-width: 0.5;
        }

        /* ãƒ›ãƒãƒ¼æ™‚ */
        .day-group:not(.today):hover {
            transform: scale(1.02);
            filter: brightness(1.1);
        }

        /* æ›œæ—¥ã®ãƒ†ã‚­ã‚¹ãƒˆ */
        .day-text {
            font-size: 8px;
            font-weight: bold;
            fill: rgba(0, 0, 0, 0.7);
            text-anchor: middle; /* æ°´å¹³ä¸­å¤®æƒãˆ */
            dominant-baseline: middle; /* å‚ç›´ä¸­å¤®æƒãˆ */
            pointer-events: none; /* ãƒ†ã‚­ã‚¹ãƒˆãŒã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’é‚ªé­”ã—ãªã„ã‚ˆã†ã« */
        }

        /* --- ä»Šæ—¥ã®æ›œæ—¥ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ --- */
        .day-group.today {
            /* ä»–ã®ãƒ”ãƒ¼ã‚¹ã‚ˆã‚Šæ‰‹å‰ã«è¡¨ç¤º */
            transform: scale(1.08);
            z-index: 10;
        }

        .day-group.today .day-slice {
            /* å½±ã‚’ã¤ã‘ã¦ç›®ç«‹ãŸã›ã‚‹ */
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            /* æ ç·šã‚’å¤ªãã™ã‚‹ */
            stroke: #ffffff;
            stroke-width: 1.5;
        }

        .day-group.today .day-text {
            fill: #000;
            font-size: 9px;
        }
    </style>
</head>
<body>
    <h1>æ›œæ—¥ã‚ˆã†ã³</h1>

    <div class="chart-container">
        <svg id="pie-chart" viewBox="0 0 100 100"></svg>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const svgNS = 'http://www.w3.org/2000/svg';
            const pie = document.getElementById('pie-chart');
            const R = 48; // åŠå¾„ (ViewBox 100 ã®ä¸­å¿ƒ 50 ã«å¯¾ã—ã¦)
            const CX = 50;
            const CY = 50;
            const sliceAngle = 360 / 7;
            
            // æ—¥æ›œæ—¥ã‚’çœŸä¸Šã«é…ç½®ã™ã‚‹ãŸã‚ã«é–‹å§‹è§’åº¦ã‚’èª¿æ•´ (-90åº¦ãŒçœŸä¸Š)
            const startAngle = -90 - sliceAngle / 2;

            // æ›œæ—¥ãƒ‡ãƒ¼ã‚¿ (JavaScriptã® getDay() ã®é †åº: 0=æ—¥, 1=æœˆ, ...)
            const days = [
                { name: 'ğŸŒæ—¥', color: '#FF9800', reading: 'ã«ã¡ã‚ˆã†ã³' }, // 0: å¤ªé™½ (ã‚ªãƒ¬ãƒ³ã‚¸)
                { name: 'ğŸŒ›æœˆğŸ«', color: '#FFEB3B', reading: 'ã’ã¤ã‚ˆã†ã³' }, // 1: æœˆ (é»„)
                { name: 'ğŸ”¥ç«ğŸ«', color: '#F44336', reading: 'ã‹ã‚ˆã†ã³' },   // 2: ç« (èµ¤)
                { name: 'ğŸ’§æ°´ğŸ«', color: '#2196F3', reading: 'ã™ã„ã‚ˆã†ã³' }, // 3: æ°´ (é’)
                { name: 'ğŸŒ³æœ¨ğŸ«', color: '#4CAF50', reading: 'ã‚‚ãã‚ˆã†ã³' }, // 4: æœ¨ (ç·‘)
                { name: 'ğŸ’°é‡‘ğŸ«ğŸ¶', color: '#FFC107', reading: 'ãã‚“ã‚ˆã†ã³' }, // 5: é‡‘ (ã‚´ãƒ¼ãƒ«ãƒ‰)
                { name: 'â›°ï¸åœŸ', color: '#795548', reading: 'ã©ã‚ˆã†ã³' }    // 6: åœŸ (èŒ¶)
            ];

            // è§’åº¦ã‚’ãƒ©ã‚¸ã‚¢ãƒ³ã«å¤‰æ›ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
            const degToRad = (deg) => deg * (Math.PI / 180);

            // åº§æ¨™ã‚’è¨ˆç®—ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
            const getCoords = (angle) => {
                const rad = degToRad(angle);
                return {
                    x: CX + R * Math.cos(rad),
                    y: CY + R * Math.sin(rad),
                };
            };

            // 1. å„æ›œæ—¥ã®ãƒ”ãƒ¼ã‚¹ï¼ˆSVGè¦ç´ ï¼‰ã‚’ç”Ÿæˆ
            days.forEach((day, index) => {
                const angle1 = startAngle + sliceAngle * index;
                const angle2 = startAngle + sliceAngle * (index + 1);

                const p1 = getCoords(angle1);
                const p2 = getCoords(angle2);

                // SVGã®ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿ (M ä¸­å¿ƒ L é–‹å§‹ç‚¹ A å††å¼§ Z é–‰ã˜ã‚‹)
                // A ${R},${R} 0 0,1 ${p2.x},${p2.y}
                // (R,R: åŠå¾„, 0: å›è»¢, 0: large-arc-flag, 1: sweep-flag)
                const d = `M ${CX},${CY} L ${p1.x},${p1.y} A ${R},${R} 0 0,1 ${p2.x},${p2.y} Z`;

                const path = document.createElementNS(svgNS, 'path');
                path.setAttribute('d', d);
                path.setAttribute('fill', day.color);
                path.classList.add('day-slice');

                // ãƒ†ã‚­ã‚¹ãƒˆã®ä½ç½®ï¼ˆå„ãƒ”ãƒ¼ã‚¹ã®ä¸­å¤®ï¼‰
                const textAngle = angle1 + sliceAngle / 2;
                const textR = R * 0.7; // ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¸­å¿ƒã‹ã‚‰70%ã®ä½ç½®ã«
                const textRad = degToRad(textAngle);
                const tx = CX + textR * Math.cos(textRad);
                const ty = CY + textR * Math.sin(textRad);

                const text = document.createElementNS(svgNS, 'text');
                text.setAttribute('x', tx);
                text.setAttribute('y', ty);
                text.textContent = day.name;
                text.classList.add('day-text');

                // ã‚°ãƒ«ãƒ¼ãƒ—åŒ– (ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã¨ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã®ãŸã‚)
                const group = document.createElementNS(svgNS, 'g');
                group.setAttribute('id', `day-${index}`);
                group.dataset.reading = day.reading; // éŸ³å£°å†ç”Ÿç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
                group.classList.add('day-group');

                group.appendChild(path);
                group.appendChild(text);

                // 2. éŸ³å£°å†ç”Ÿã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ 
                group.addEventListener('click', () => {
                    playSpeech(day.reading);
                });

                pie.appendChild(group);
            });

            // 3. ä»Šæ—¥ã®æ›œæ—¥ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹é–¢æ•°
            const updateHighlight = () => {
                const todayIndex = new Date().getDay(); // 0=æ—¥, 1=æœˆ, ...

                // ã™ã¹ã¦ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’ä¸€æ—¦è§£é™¤
                document.querySelectorAll('.day-group.today').forEach((el) => {
                    el.classList.remove('today');
                });

                // ä»Šæ—¥ã®æ›œæ—¥ã« 'today' ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
                const todayElement = document.getElementById(`day-${todayIndex}`);
                if (todayElement) {
                    todayElement.classList.add('today');
                }
            };

            // 4. éŸ³å£°å†ç”Ÿé–¢æ•° (Web Speech API)
            const playSpeech = (text) => {
                // ãƒ–ãƒ©ã‚¦ã‚¶ãŒéŸ³å£°åˆæˆã«å¯¾å¿œã—ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                if (!window.speechSynthesis) {
                    alert('ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°åˆæˆã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚');
                    return;
                }
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP'; // æ—¥æœ¬èªã«è¨­å®š
                utterance.rate = 1.0; // èª­ã¿ä¸Šã’é€Ÿåº¦
                speechSynthesis.speak(utterance);
            };

            // 5. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°å‡¦ç†
            // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆå›å®Ÿè¡Œ
            updateHighlight();

            // ãã®å¾Œã€1åˆ†ã”ã¨ã«æ—¥ä»˜ãŒå¤‰ã‚ã£ã¦ã„ãªã„ã‹ãƒã‚§ãƒƒã‚¯
            setInterval(updateHighlight, 60000); 
        });
    </script>
</body>
</html>